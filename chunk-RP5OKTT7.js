import{a as y,b as _,c as R,d as V,f as j,g as q,h as N,i as I,k as G}from"./chunk-6RHAI3ON.js";import{f as T}from"./chunk-Q6M5HNXJ.js";import{Cb as m,Db as F,Oa as o,Pa as b,U as P,Xa as h,Z as S,_ as w,bb as d,ea as f,fa as g,hb as u,lb as l,pb as a,qb as r,rb as c,ub as C,vc as E,wb as x,xb as p}from"./chunk-NO3ABJ5Q.js";var v=class t{constructor(n){this.http=n}baseUrl="https://ecommerce.routemisr.com/api/v1/auth/";forgetPassword(n){return this.http.post(this.baseUrl+"forgotPasswords",n)}resetCode(n){return this.http.post(this.baseUrl+"verifyResetCode",n)}newPassword(n){return this.http.put(this.baseUrl+"resetPassword",n)}static \u0275fac=function(e){return new(e||t)(S(E))};static \u0275prov=P({token:t,factory:t.\u0275fac,providedIn:"root"})};function M(t,n){t&1&&(a(0,"p"),m(1,"email is required"),r())}function k(t,n){t&1&&(a(0,"p"),m(1,"email invalid Format"),r())}function U(t,n){if(t&1&&(a(0,"div",5),d(1,M,2,0,"p")(2,k,2,0,"p"),r()),t&2){let e,i,s=p(2);o(),l((e=s.forgetPasswordForm.get("email"))!=null&&e.getError("required")?1:-1),o(),l((i=s.forgetPasswordForm.get("email"))!=null&&i.getError("email")?2:-1)}}function H(t,n){if(t&1&&(a(0,"p",6),m(1),r()),t&2){let e=p(2);o(),F(e.message)}}function A(t,n){t&1&&c(0,"i",9)}function z(t,n){if(t&1){let e=C();a(0,"section",0)(1,"form",1),x("ngSubmit",function(){f(e);let s=p();return g(s.submitForgetForm())}),a(2,"div",2)(3,"label",3),m(4,"Email address"),r(),c(5,"input",4),d(6,U,3,2,"div",5),r(),d(7,H,2,1,"p",6),a(8,"div",7)(9,"button",8),d(10,A,1,0,"i",9),m(11," Submit "),r()()()()}if(t&2){let e,i=p();o(),u("formGroup",i.forgetPasswordForm),o(5),l((e=i.forgetPasswordForm.get("email"))!=null&&e.errors&&((e=i.forgetPasswordForm.get("email"))!=null&&e.touched)?6:-1),o(),l(i.message!=""?7:-1),o(2),u("disabled",!i.forgetPasswordForm.valid),o(),l(i.regSpinner?10:-1)}}function Z(t,n){t&1&&(a(0,"p"),m(1,"code is required"),r())}function $(t,n){if(t&1&&(a(0,"div",5),d(1,Z,2,0,"p"),r()),t&2){let e,i=p(2);o(),l((e=i.resetCodeForm.get("resetCode"))!=null&&e.getError("required")?1:-1)}}function J(t,n){if(t&1&&(a(0,"p",6),m(1),r()),t&2){let e=p(2);o(),F(e.message)}}function K(t,n){t&1&&c(0,"i",9)}function L(t,n){if(t&1){let e=C();a(0,"section",0)(1,"form",10),x("ngSubmit",function(){f(e);let s=p();return g(s.submitCodeForm())}),a(2,"div",11)(3,"label",12),m(4," Reset Code"),r(),c(5,"input",13),d(6,$,2,1,"div",5),r(),d(7,J,2,1,"p",6),a(8,"div",7)(9,"button",8),d(10,K,1,0,"i",9),m(11," Submit "),r()()()()}if(t&2){let e,i=p();o(),u("formGroup",i.resetCodeForm),o(5),l((e=i.resetCodeForm.get("resetCode"))!=null&&e.errors&&((e=i.resetCodeForm.get("resetCode"))!=null&&e.touched)?6:-1),o(),l(i.message!=""?7:-1),o(2),u("disabled",!i.resetCodeForm.valid),o(),l(i.regSpinner?10:-1)}}function Q(t,n){t&1&&(a(0,"p"),m(1,"email is required"),r())}function W(t,n){t&1&&(a(0,"p"),m(1,"email InValid Format"),r())}function X(t,n){if(t&1&&(a(0,"div",5),d(1,Q,2,0,"p")(2,W,2,0,"p"),r()),t&2){let e,i,s=p(2);o(),l((e=s.endResetPass.get("email"))!=null&&e.getError("required")?1:-1),o(),l((i=s.endResetPass.get("email"))!=null&&i.getError("email")?2:-1)}}function Y(t,n){t&1&&(a(0,"p"),m(1,"password is required"),r())}function ee(t,n){t&1&&(a(0,"p"),m(1,"must be at least 6 chars"),r())}function te(t,n){if(t&1&&(a(0,"div",5),d(1,Y,2,0,"p")(2,ee,2,0,"p"),r()),t&2){let e,i,s=p(2);o(),l((e=s.endResetPass.get("newPassword"))!=null&&e.getError("required")?1:-1),o(),l((i=s.endResetPass.get("newPassword"))!=null&&i.getError("pattern")?2:-1)}}function ie(t,n){t&1&&c(0,"i",9)}function ne(t,n){if(t&1){let e=C();a(0,"section",0)(1,"form",10),x("ngSubmit",function(){f(e);let s=p();return g(s.submitEndForm())}),a(2,"div",14)(3,"label",3),m(4,"Email address"),r(),c(5,"input",4),d(6,X,3,2,"div",5),r(),a(7,"div",14)(8,"label",15),m(9,"New password"),r(),c(10,"input",16),d(11,te,3,2,"div",5),r(),a(12,"div",7)(13,"button",8),d(14,ie,1,0,"i",9),m(15," Submit "),r()()()()}if(t&2){let e,i,s=p();o(),u("formGroup",s.endResetPass),o(5),l((e=s.endResetPass.get("email"))!=null&&e.errors&&((e=s.endResetPass.get("email"))!=null&&e.touched)?6:-1),o(5),l((i=s.endResetPass.get("newPassword"))!=null&&i.errors&&((i=s.endResetPass.get("newPassword"))!=null&&i.touched)?11:-1),o(2),u("disabled",!s.endResetPass.valid),o(),l(s.regSpinner?14:-1)}}var O=class t{constructor(n,e){this._Router=n;this._ForgetpassService=e}step1=!0;step2=!1;step3=!1;message="";regSpinner=!1;formBuilder=w(I);forgetPasswordForm=this.formBuilder.group({email:["",[_.required,_.email]]});resetCodeForm=this.formBuilder.group({resetCode:["",[_.required]]});endResetPass=this.formBuilder.group({email:["",[_.required,_.email]],newPassword:["",[_.required,_.pattern(/^[a-zA-Z0-9_@]{6,}$/)]]});submitForgetForm(){this.regSpinner=!0;let n=this.forgetPasswordForm.value;this._ForgetpassService.forgetPassword(n).subscribe({next:e=>{this.regSpinner=!1,this.message=e.message,this.step1=!1,this.step2=!0},error:e=>{this.regSpinner=!1,this.message=e.error.message}})}submitCodeForm(){this.regSpinner=!0;let n=this.resetCodeForm.value;this._ForgetpassService.resetCode(n).subscribe({next:e=>{this.regSpinner=!1,this.message="",this.step2=!1,this.step3=!0},error:e=>{this.regSpinner=!1,this.message=e.error.message}})}submitEndForm(){this.regSpinner=!0;let n=this.endResetPass.value;this._ForgetpassService.newPassword(n).subscribe({next:e=>{this.regSpinner=!1,e.token&&(localStorage.setItem("token",e.token),this._Router.navigate(["/home"]))},error:e=>{this.regSpinner=!1,this.message=e.error.message}})}static \u0275fac=function(e){return new(e||t)(b(T),b(v))};static \u0275cmp=h({type:t,selectors:[["app-forget-pass"]],decls:3,vars:3,consts:[[1,"d-flex","justify-content-center","mt-5"],[1,"forget-form","p-4","mt-5",3,"ngSubmit","formGroup"],[1,"mb-2"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email",1,"form-control"],[1,"errors"],[1,"text-end","jasper-color","m-0"],[1,"d-flex","justify-content-between","align-items-center"],["type","submit",1,"main-btn",3,"disabled"],[1,"fas","fa-spinner","fa-spin","me-1"],[1,"forget-form","p-4",3,"ngSubmit","formGroup"],[1,"mb-1"],["for","resetCode",1,"form-label"],["type","text","id","resetCode","formControlName","resetCode",1,"form-control"],[1,"mb-3"],["for","newPassword",1,"form-label"],["type","password","id","newPassword","formControlName","newPassword",1,"form-control"]],template:function(e,i){e&1&&d(0,z,12,5,"section",0)(1,L,12,5,"section",0)(2,ne,16,5,"section",0),e&2&&(l(i.step1?0:-1),o(),l(i.step2?1:-1),o(),l(i.step3?2:-1))},dependencies:[G,j,y,R,V,q,N],styles:[".forget-form[_ngcontent-%COMP%]{width:50%}@media (max-width: 768px){.forget-form[_ngcontent-%COMP%]{width:80%}}"]})};export{O as ForgetPassComponent};
